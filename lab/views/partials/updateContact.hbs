<div>
    <form action="/update" method="POST">

        <div class="Menu">
            <input type="hidden" name="id" value="{{user.id}}">
            <input id="name" value="{{user.name}}" name="name" type="text" onchange="BlockRemove()" onclick="BlockRemove()" placeholder="name">
            <input id="name2" value="{{user.number}}" name="number" type="text" onchange="BlockRemove2()" onclick="BlockRemove2()" placeholder="phone">
        </div>

        <div class="Menu">
            <button id="addBtn" type="submit" onmouseenter="ValidateNumber()">Изменить</button>
            <button id="delBtn" type="button" onmouseenter="ValidateNumber()" onclick="deleteUser('{{user.id}}')">Удалить</button>
            <button type="button" onclick="{{exit}}">Отказаться</button>
        </div>

    </form>
</div>
<script>
    let name = null;
    let number = null;

    function deleteUser(userId) {
        fetch(`/delete/${userId}`, {
                method: 'DELETE'
            })
            .then(response => response.json())
            .then(data => {
                window.location = '/main'
                console.log(data);
            })
            .catch(error => {
                window.location = '/main'
                console.error('Error:', error);
            });
    }

    function BlockRemove() {
        if (name == null)
            name = document.getElementById('name').value;
        if (document.getElementById('name').value != name)
            document.getElementById('delBtn').disabled = true;
        if (document.getElementById('name').value == name)
            document.getElementById('delBtn').disabled = false;
    }

    function BlockRemove2() {
        if (number == null)
            number = document.getElementById('name2').value;
        if (document.getElementById('name2').value != number)
            document.getElementById('delBtn').disabled = true;
        if (document.getElementById('name2').value == number)
            document.getElementById('delBtn').disabled = false;
    }

    function ValidateNumber() {
        document.getElementById('addBtn').disabled = true;

        let valide1 = false;
        let valide2 = false;

        if (document.getElementById('name2').value.length === 12) {
            valide1 = true;
        }

        let A1 = [3, 7, 5, 2, 9];
        for (let i = 0; i < 5; i++) {
            if (parseInt(document.getElementById('name2').value[i]) === A1[i]) {
                valide2 = true;
            } else {
                valide2 = false;
                break; 
            }
        }

        if (!valide1 || !valide2) {
            document.getElementById('addBtn').disabled = true;
        } else {
            document.getElementById('addBtn').disabled = false;
        }
    }
</script>
